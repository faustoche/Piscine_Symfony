{% extends 'base.html.twig' %}

{% block content %}
    {# Section des notifications centrées #}
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert" style="color: {{ label == 'error' ? '#721c24' : '#155724' }}; background-color: {{ label == 'error' ? '#f8d7da' : '#d4edda' }}; border-color: {{ label == 'error' ? '#f5c6cb' : '#c3e6cb' }};">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}

    <div class="card" style="min-width: 95%; margin-top: 20px;">

        {# --- ACTIONS D'IMPORTATION --- #}
        <div style="margin-bottom: 30px; padding: 20px; background-color: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
            <p style="color: #64748b; margin-top: 0;">Make sure file <code>source.txt</code> does exist at the root of the project.</p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <a href="{{ path('ex10_import_run') }}" style="text-decoration: none;">
                    <button type="button" style="background-color: #2563eb; color: white; padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">
                        Launch importation
                    </button>
                </a>
                <a href="{{ path('ex10_import_clear') }}" style="text-decoration: none;">
                    <button type="button" style="background-color: transparent; color: #eb255aff; border: 1px solid #eb255aff; padding: 12px 20px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                        Empty tables
                    </button>
                </a>
            </div>
        </div>

        {# --- COMPARAISON DES DONNÉES --- #}
        <div style="display: flex; gap: 25px; align-items: flex-start;">
            
            {# Colonne ORM #}
            <div style="flex: 1; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px;">
                <h3 style="color: #2563eb; margin-top: 0;">ORM (Entity)</h3>
                <p style="font-size: 0.85rem; color: #64748b;">Table : <code>orm_data</code></p>
                <table style="width: 100%; border-collapse: collapse; text-align: left; font-size: 0.9rem;">
                    <thead>
                        <tr style="background-color: #f1f5f9;">
                            <th style="padding: 10px; border: 1px solid #cbd5e1;">ID</th>
                            <th style="padding: 10px; border: 1px solid #cbd5e1;">Content</th>
                            <th style="padding: 10px; border: 1px solid #cbd5e1;">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in ormData %}
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e2e8f0;">{{ item.id }}</td>
                                <td style="padding: 8px; border: 1px solid #e2e8f0;">{{ item.content }}</td>
                                <td style="padding: 8px; border: 1px solid #e2e8f0;">{{ item.importedAt|date('H:i:s') }}</td>
                            </tr>
                        {% else %}
                            <tr><td colspan="3" style="padding: 15px; text-align: center; color: #94a3b8;">No ORM data</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            {# Colonne SQL #}
            <div style="flex: 1; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px;">
                <h3 style="color: #475569; margin-top: 0;">SQL (Raw)</h3>
                <p style="font-size: 0.85rem; color: #64748b;">Table : <code>sql_data</code></p>
                <table style="width: 100%; border-collapse: collapse; text-align: left; font-size: 0.9rem;">
                    <thead>
                        <tr style="background-color: #f1f5f9;">
                            <th style="padding: 10px; border: 1px solid #cbd5e1;">ID</th>
                            <th style="padding: 10px; border: 1px solid #cbd5e1;">Raw Content</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in sqlData %}
                            <tr>
                                <td style="padding: 8px; border: 1px solid #e2e8f0;">{{ row.id }}</td>
                                <td style="padding: 8px; border: 1px solid #e2e8f0;">{{ row.raw_content }}</td>
                            </tr>
                        {% else %}
                            <tr><td colspan="2" style="padding: 15px; text-align: center; color: #94a3b8;">No SQL data</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

        </div>
    </div>
{% endblock %}