{% extends 'e04/base.html.twig' %}

{% block body %}

    <h1>Exercice 04 : SQL and form</h1>

    <div style="margin-bottom: 20px;">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="flash-{{ label }}" style="padding: 10px; border: 1px solid #333; background-color: {{ label == 'error' ? '#f8d7da' : '#d4edda' }}; color: {{ label == 'error' ? 'red' : 'green' }}; margin-bottom: 5px;">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}
    </div>


    {# --- PARTIE 1 : LE FORMULAIRE SYMFONY --- #}
    <div style="margin-bottom: 20px; border: 1px solid #ccc; padding: 20px;">
        <h3>Add a person</h3>
        
        {# C'est cette ligne magique qui affiche tous tes champs (add) et ton bouton #}
        {{ form(form) }}
    </div>

    {# --- PARTIE 2 : LE TABLEAU DES RÉSULTATS --- #}
    <div>
        <h3>Subscribers (Database)</h3>
        
        <table border="1" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Date of birth</th>
                    <th>Address</th>
                    <th>Action</th>

                </tr>
            </thead>
            <tbody>
                {# On boucle sur la variable 'persons' envoyée par le contrôleur #}
                {% for person in persons %}
                    <tr>
                        <td>{{ person.id }}</td>
                        <td>{{ person.username }}</td>
                        <td>{{ person.name }}</td>
                        <td>{{ person.email }}</td>
                        <td>{{ person.birthdate }}</td>
                        <td>{{ person.address }}</td>
                        <td style="text-align: center;">
                            <a href="{{ path('e04_delete', {id: person.id}) }}"
                                onclick="return confirm('Are you sure you want to delete this element?');"
                                style="color: red; text-decoration: none; font-weight: bold;">
                                [DELETE]
                            </a>
                        </td>
                    </tr>
                {# Si la liste est vide, on affiche un message #}
                {% else %}
                    <tr>
                        <td colspan="6">No one has been found in the table.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}